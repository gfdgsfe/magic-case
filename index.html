<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #05070a; color: white; font-family: sans-serif; margin: 0; padding: 0; user-select: none; -webkit-tap-highlight-color: transparent; }
        .btn-case { 
            background: #161b22; border: 1px solid #30363d; border-radius: 12px; 
            padding: 16px; margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between;
            position: relative; z-index: 999; touch-action: manipulation;
        }
        .btn-case:active { background: #1c2128; transform: scale(0.98); }
        
        #roulette-screen { display: none; position: fixed; inset: 0; background: #05070a; z-index: 10000; }
        .win-window { position: relative; width: 100%; height: 160px; background: #0d1117; overflow: hidden; border-y: 2px solid #30363d; margin-top: 40%; }
        .line { display: flex; position: absolute; left: 0; height: 100%; transition: transform 6s cubic-bezier(0.1, 0, 0.1, 1); }
        .item-card { min-width: 120px; height: 160px; display: flex; flex-direction: column; align-items: center; justify-content: center; border-right: 1px solid #161b22; }
        .marker { position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background: #fbbf24; z-index: 20; transform: translateX(-50%); box-shadow: 0 0 15px #fbbf24; }
    </style>
</head>
<body class="p-4">

    <div id="main-menu">
        <div class="flex justify-between items-center mb-8">
            <h1 class="text-xl font-bold italic text-yellow-500">CASE MINT</h1>
            <div class="bg-slate-900 border border-yellow-500/30 px-4 py-1 rounded-full text-sm">‚≠ê 1,250</div>
        </div>

        <div class="btn-case" onpointerdown="handlePress('Standard', 100)">
            <div class="flex items-center gap-4">
                <span class="text-4xl">üì¶</span>
                <div>
                    <div class="font-bold">Standard Case</div>
                    <div class="text-[10px] text-gray-400">RTP 70%</div>
                </div>
            </div>
            <div class="bg-yellow-500 text-black font-black px-3 py-1.5 rounded-lg text-xs">100 ‚≠ê</div>
        </div>

        <div class="btn-case" onpointerdown="handlePress('Rare', 500)">
            <div class="flex items-center gap-4">
                <span class="text-4xl">üíé</span>
                <div>
                    <div class="font-bold text-blue-400">Rare Chest</div>
                    <div class="text-[10px] text-gray-400">RTP 70%</div>
                </div>
            </div>
            <div class="bg-blue-600 text-white font-black px-3 py-1.5 rounded-lg text-xs">500 ‚≠ê</div>
        </div>
    </div>

    <div id="roulette-screen">
        <div class="win-window">
            <div class="marker"></div>
            <div id="tape" class="line"></div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        const PRIZES = {
            'Standard': [{e:'üí©',v:'10 ‚≠ê',c:40}, {e:'ü™ô',v:'50 ‚≠ê',c:35}, {e:'üíé',v:'200 ‚≠ê',c:20}, {e:'üèÜ',v:'1000 ‚≠ê',c:5}],
            'Rare': [{e:'ü™ô',v:'50 ‚≠ê',c:45}, {e:'üíé',v:'300 ‚≠ê',c:35}, {e:'üîã',v:'1000 ‚≠ê',c:15}, {e:'üëë',v:'5000 ‚≠ê',c:5}]
        };

        function handlePress(type, price) {
            tg.HapticFeedback.impactOccurred('medium');
            tg.showConfirm(`–û—Ç–∫—Ä—ã—Ç—å ${type} –∑–∞ ${price} ‚≠ê?`, function(ok) {
                if (ok) startAnimation(type);
            });
        }

        function startAnimation(type) {
            const items = PRIZES[type];
            document.getElementById('main-menu').style.display = 'none';
            const screen = document.getElementById('roulette-screen');
            const tape = document.getElementById('tape');
            screen.style.display = 'block';
            let pool = [];
            for (let i = 0; i < 70; i++) {
                const r = Math.random() * 100;
                let s = 0, win;
                for (let itm of items) {
                    s += itm.c;
                    if (r <= s) { win = itm; break; }
                }
                pool.push(win);
                const el = document.createElement('div');
                el.className = 'item-card';
                el.innerHTML = <div style="font-size:40px">${win.e}</div><div style="font-size:12px;font-weight:bold;margin-top:10px">${win.v}</div>;
                tape.appendChild(el);
            }

            const cardWidth = 121;
            const target = 65;
            const stop = (target * cardWidth) - (window.innerWidth / 2) + (cardWidth / 2);

            setTimeout(() => {
                tape.style.transform = translateX(-${stop}px);
            }, 50);

            setTimeout(() => {
                tg.showPopup({
                    title: 'üéâ –ü–†–ò–ó!',
                    message: –í—ã–∏–≥—Ä—ã—à: ${pool[target].v},
                    buttons: [{type: 'ok', text: '–û–ö'}]
                }, () => location.reload());
            }, 6500);
        }
    </script>
</body>
</html>
